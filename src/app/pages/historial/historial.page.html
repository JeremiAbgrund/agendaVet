<ion-header class="historial-header" translucent="true">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home"></ion-back-button>
    </ion-buttons>
    <ion-title>Historial de soporte</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="historial-content" [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <section class="hero ion-padding">
    <h1>Últimas solicitudes</h1>
    <p>Filtra por tipo de consulta para revisar el seguimiento.</p>
    <mat-chip-set class="filters">
      <mat-chip-option
        *ngFor="let topic of topics"
        [selected]="selectedTopic === topic"
        (click)="selectTopic(topic)">
        {{ topic | titlecase }}
      </mat-chip-option>
    </mat-chip-set>
  </section>

  <ion-list lines="full" *ngIf="filteredRequests.length; else empty">
    <ion-item *ngFor="let request of filteredRequests">
      <ion-avatar slot="start">
        <ion-icon name="document-text-outline"></ion-icon>
      </ion-avatar>
      <ion-label>
        <h2>{{ request.topic | titlecase }} · {{ request.preferredChannel }}</h2>
        <p>{{ request.message }}</p>
        <ion-note color="medium">{{ request.createdAt | date:'medium' }}</ion-note>
      </ion-label>
    </ion-item>
  </ion-list>

  <ng-template #empty>
    <div class="empty-state">
      <ion-icon name="archive-outline"></ion-icon>
      <p>No hay solicitudes registradas para este filtro.</p>
    </div>
  </ng-template>
</ion-content>
